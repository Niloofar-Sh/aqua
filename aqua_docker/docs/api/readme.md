# AQUA - API
# About
API module for AQUA SPARK

## Searching for datasets
#### Format:
    GET /search?query={query}&force={yes|no}

  - query : is a query terms (optional)
  - force : an argument to force the server to execute the query
    - yes : the query is not modify
    - no : the query is modified if results are not found

#### Examples:
- A GET request without additional arguments will return all datasets
  - `http://130.216.216.55/search`
- Example of query: `rat`
  - `http://130.216.216.55/search?query=rat`
    - since `rat` is available, query `rat` is executed
- Example of query: `rattis`
  - `http://130.216.216.55/search?query=ratis`
    - since `rattis` is not available, `rattus` is executed
  - `http://130.216.216.55/search?query=ratis&force=yes`
    - although `rattis` is not available, it is forced to execute
    - no results

#### Return format:
    {
      "query": "rattus",
      "executed": "rattus",
      "force": "no",
      "suggestions": ["rattle", "rattus sp.", "rousettus"],
      "total": 27,
      "filters": {
      "keywords": {
        "vagus nerve stimulation": ["60", "16", "9"],
        "stomach": ["12", "9", "123", "107", "121", "105"],
        ....
        },
      "authors": {
        "Terry Powley": ["10", "12", "9", "123", "107", "90", "11", "24", "121"],
        "Robert Phillips": ["10", "12", "9", "123", "11", "24"],
        ....
        }
      },
      "sorts": {
        "ranking": ["29", "60", "20", "16", "21", "10", "12", "9", "139", "123", "77", "51", "107", "88", "90", "130", "37", "31", "11", "106", "48", "24", "121", "52", "151", "62", "105"],
        "date": ["151", "139", "105", "130", "123", "121", "107", "106", "90", "60", "88", "77", "37", "16", "51", "29", "12", "11", "10", "62", "20", "21", "52", "24", "31", "9", "48"]
      },
      "hits": {
        "29": {
          "url": "https:\/\/sparc.science\/datasets\/29",
          "banner": "https:\/\/assets.discover.pennsieve.io\/dataset-assets\/29\/6\/revisions\/1\/banner.jpg",
          "_id": "DOI:10.26275\/xmyx-rnm9",
          "_score": 1.1826954,
          "date": "2020-03-05T18:01:19.269981Z",
          "name": "Molecular Phenotype Distribution of Single Rat ICN Neurons",
          "description": "We developed an approach to appreciating the 3D organization of the ICN while at the same time permitting single cell transcriptomics and connectomics. Through serial cryostat sectioning of a cryopreserved heart with imaging of serially collected and stained sections, it is possible to reconstruct the 3D context and collect single neurons using laser microdissection. The transcriptional profiles of these isolated neurons can be determined down to single cell resolution and mapped back into the 3D context generated by stacking the serial images.",
          "readme": {
            "description": "**Study purpose:** The purpose of this study was to create comprehensive atlas of the cardiac ICN in rat at a cellular level providing gene expression profiles of cardiac neurons on single cell resolution. We developed an approach to appreciate the 3D organization of the intracardiac neurons, ICN, while at the same time permitting single cell transcriptomics and connectomics.\n\n**Data collection:** This dataset contains two components. 1. Cardiac neuron gene expression profiling from Real-time quantitative PCR generated by the Fluidigm Dynamic Array: For the data presented in this investigation, data from four 96 well chips were combined into a single matrix and processed further in normalization. The transcriptomic data set consists of 23,254 data points from 151 samples of both single neurons and neuron pools capturing entire clusters. The gene list and primers information available in HB-ICN-4chiprun-design.xlsx file within source folder;. 2.  Images of heart samples collected using the Arcturus Laser Capture Microdisection: Images are single sections from a female rat heart in which the 3D organization of the ICN is mapped. The heart was sectioned in the transverse plane going rostro-caudally between the base and apex. \n\n**Primary Conclusion:** Through serial cryostat sectioning of a cryopreserved heart with imaging of serially collected and stained sections, it is possible to reconstruct the 3D context and collect single neurons using laser microdissection. The transcriptional profiles of these isolated neurons can be determined down to single cell resolution and mapped back into the 3D context generated by stacking the serial images.\n\n\n---\n\n**Curator's Notes**\n\n**Experimental Design:** The subject was sacrificed using 5% isoflurane inhalation until unconscious and then decapitated. The heart was immediately removed and embedded prior to sectioning, Cresyl Violet staining, and then was imaged. The experimenters used laser capture microdissection to extract single neurons for gene expression analysis.\n\n**Completeness:** Batch.\n\n**Subjects\/Samples:** 10 week old, female, Sprague Dawley rat.\n\n**Primary vs. Derivative:** The primary folder contains sample collection and sample labeling information alongside sample acquisition images. The derivative folder contains a normalized data files, spatial mapping data, and a supplementary images."
          }
        },
        "60": { .... },
        ....
      }
    }

## Get query autocomplete
#### Format:
    GET /autocomplete?query=query&limit={limit}&verbose={yes|no}

- query : is a query terms (mandatory)
- limit : the number of returns
- verbose :
  - no : get list of autocomplete
  - yes : get detail autocomplete in json format

#### Example:
- Example of query: `rat`
  - `http://130.216.216.55/autocomplete?query=rat&limit=10`
    - get autocomplete of rat as a list
    - return 10 phrases
  - `http://130.216.216.55/autocomplete?query=rat`
    - get autocomplete of rat as a list
  - `http://130.216.216.55/autocomplete?query=rat&limit=10&verbose=true`
    - get autocomplete of rat as a detail dictionary
    - return 10 phrases

## Get query suggestions
#### Format:
    GET /suggestions?query=query&limit={limit}

- query : is a query terms (mandatory)
- limit : the number of returns

#### Example:
- Example of query: `rat`
  - `http://130.216.216.55/suggestions?query=rat&limit=10`
    - get autocomplete of rat as a list
    - return 10 phrases
  - `http://130.216.216.55/suggestions?query=rat`
    - get autocomplete of rat as a list
